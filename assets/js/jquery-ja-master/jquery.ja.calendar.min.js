
(function($){(function(){var fDateParse=Date.parse;Date.parse=function(sDateString){var a_sLanguage=['en','en-us'],a_sMatches=null,sCurrentLanguage,dReturn=null,i;for(i=0;i<a_sLanguage.length;i++){sCurrentLanguage=(a_sLanguage[i]+'').toLowerCase();if(sCurrentLanguage.indexOf('en')==0){if(sCurrentLanguage.indexOf('en-us')==-1&&sCurrentLanguage.indexOf('en-ca')==-1&&sCurrentLanguage.indexOf('en-ph')==-1&&sCurrentLanguage.indexOf('en-bz')==-1){var oRegEx=new RegExp("(([0-9]{2}|[0-9]{1})[^0-9]*?([0-9]{2}|[0-9]{1})[^0-9]*?([0-9]{4}))","i");a_sMatches=oRegEx.exec(sDateString);}
break;}}
if(a_sMatches!=null){var oRegEx=new RegExp(a_sMatches[0],"i");dReturn=fDateParse(sDateString.replace(oRegEx,a_sMatches[4]+"/"+a_sMatches[3]+"/"+a_sMatches[2]));}
else{dReturn=fDateParse(sDateString);}
return dReturn;}})();Date.prototype.toDayMonthYearDate=function()
{return(this.getDate()<10?'0'+this.getDate():this.getDate())
+'/'
+(this.getMonth()+1<10?'0'+(this.getMonth()+1):this.getMonth()+1)
+'/'
+this.getFullYear();};var $newRow=function()
{return $("<tr />");}
var getWeeksInMonth=function(year,month_number){var firstOfMonth=new Date(year,month_number-1,1);var lastOfMonth=new Date(year,month_number,0);var used=firstOfMonth.getDay()+lastOfMonth.getDate();return Math.ceil(used/7);}
function y2k(number){return(number<1000)?number+1900:number;}
function getWeek(year,month,day){var when=new Date(year,month,day);var newYear=new Date(year,0,1);var modDay=newYear.getDay();if(modDay==0)modDay=6;else modDay--;var daynum=((Date.UTC(y2k(year),when.getMonth(),when.getDate(),0,0,0)-
Date.UTC(y2k(year),0,1,0,0,0))/1000/60/60/24)+1;if(modDay<4){var weeknum=Math.floor((daynum+modDay-1)/7)+1;}
else{var weeknum=Math.floor((daynum+modDay-1)/7);if(weeknum==0){year--;var prevNewYear=new Date(year,0,1);var prevmodDay=prevNewYear.getDay();if(prevmodDay==0)prevmodDay=6;else prevmodDay--;if(prevmodDay<4)weeknum=53;else weeknum=52;}}
return weeknum;}
$.fn.jaCalendar=function(method)
{var methods={init:function(options)
{var settings=$.extend({},$.fn.jaCalendar.defaults,options);var $target=settings.target?settings.target:$(this);var days=settings.days;var months=settings.months;var dateBase=new Date();var year=dateBase.getFullYear();var month=dateBase.getMonth();var todayDate=new Date(year,month,dateBase.getDate());var selectedMonth=settings.month-1;var selectedYear=settings.year;var daysInMonth=new Date(selectedYear,selectedMonth+1,0).getDate();var weeksInMonth=getWeeksInMonth(selectedYear,selectedMonth);var firstDayOfMonth=new Date(selectedYear,selectedMonth,1);var firstWeekday=firstDayOfMonth.getDay();var specialDates=[];$.each(settings.specialDates,function(i,sdObject){$.each(sdObject.dates,function(j,sdate){specialDates.push({date:new Date(Date.parse(sdate)),selectable:sdObject.selectable,dateClass:sdObject.dateClass})});});var isSpecialDate=function(aDate)
{for(var i=0;i<specialDates.length;i++)
if(+specialDates[i].date==+aDate)
return i;return-1;}
var renderDays=function()
{var $days=$("td.date",$target);var $firstDay=$("td.date.day"+firstWeekday+".week1",$target);for(var i=$days.index($firstDay),d=1,x=0;i<$days.length,d<daysInMonth,x<daysInMonth;i++,d++,x++)
{var thisDate=new Date(selectedYear,selectedMonth,d);var $thisDay=$($days[i]);$thisDay.html(settings.leadingZero?(d<10?'0'+d:d):d).data("date",thisDate).addClass("selectable");if(+thisDate==+todayDate)
$thisDay.addClass("today");switch(settings.selectionMode)
{case"single":if(+thisDate==+$target.data("selectedDate.jaCalendar"))
$thisDay.addClass("selected");break;case"range":if($target.data("selectedDate.jaCalendar")!==undefined)
{var range=$target.data("selectedDate.jaCalendar");if(+range.from<=+thisDate&&+thisDate<=+range.to)
$thisDay.addClass("selected");}
break;}
var sdIndex=isSpecialDate(thisDate);if(sdIndex>-1)
{$thisDay.addClass(specialDates[sdIndex].dateClass);if(!specialDates[sdIndex].selectable)
$thisDay.removeClass("selectable");}
if(!settings.allowPastDates&&+thisDate<+todayDate)
$thisDay.removeClass("selectable").addClass("past");}
var $lastDay=$("td.date:contains('"+daysInMonth+"')",$target);$("td.date:gt("+$days.index($lastDay)+"):empty",$target).remove();$("tr:empty",$target).remove();$("td.date:empty",$target).removeClass("date");$("td.date.selectable",$target).click(function(e){$.fn.jaCalendar.selectDate.apply($(this),[$target,settings]);});}
if($(".calendar",$target).length===0)
{var $table=$("<table class='calendar' />");$.each($.fn.jaCalendar.header(settings,selectedYear,selectedMonth),function(i,obj){$(obj).appendTo($table);});$.each($.fn.jaCalendar.weekdays(weeksInMonth),function(i,obj){$(obj).appendTo($table);});$table.appendTo($target);renderDays();settings.month=selectedMonth+1;settings.year=selectedYear;$("button.prev-month",$target).click(function(){methods.prevMonth.apply($target);return false;});$("button.next-month",$target).click(function(){methods.nextMonth.apply($target);return false;});$.each($.fn.jaCalendar.footer(settings),function(i,obj){$(obj).appendTo($table);});$("button.today-button",$target).click(function(){methods.now.apply($target);return false;});$("button.go-period-button",$target).click(function(){methods.changePeriod.apply($target,[parseInt($(".calendar .month-list",$target).val())+1,$(".calendar .year-input",$target).val()]);return false;});$("input.year-input",$target).keypress(function(e){return"1234567890".indexOf(String.fromCharCode(e.keyCode))>-1;});$target.bind("selectedDateChanged",function(){if(typeof settings.selectedDateChanged==="function")
settings.selectedDateChanged.apply($target,[$target.data("selectedDate.jaCalendar"),settings.selectionMode]);});$target.bind("selectedRangeChanged",function(){if(typeof settings.selectedRangeChanged==="function")
settings.selectedRangeChanged.apply($target,[$target.data("selectedDate.jaCalendar"),$target.jaCalendar("dateDiff")]);});$target.bind("beforePeriodChange",function(){if(typeof settings.beforePeriodChange==="function")
settings.beforePeriodChange.apply($target,[settings.currentMonth,settings.currentYear]);});$target.bind("periodChanged",function(){if(typeof settings.periodChanged==="function")
settings.periodChanged.apply($target,[settings.currentMonth,settings.currentYear]);});}
else
{var $table=$(".calendar",$target);$("tr.weekrow",$target).remove();$.each($.fn.jaCalendar.weekdays(weeksInMonth),function(i,obj){$(obj).insertBefore($('.footer',$target));});renderDays();if(!settings.usePeriodInput)
{$(".calendar .header-label",$target).html($.fn.jaCalendar.period(settings,selectedYear,selectedMonth));}
else
{$(".calendar .month-list option[value='"+selectedMonth+"']").attr("selected","selected");$(".calendar .year-input").val(selectedYear);}}
$target.data("settings.jaCalendar",settings);return $target;},getDate:function()
{return this.data("selectedDate.jaCalendar");},getToday:function()
{return $("td.date.today",this).data("date");},nextMonth:function()
{$(this).trigger("beforePeriodChange");var newSettings=$(this).data("settings.jaCalendar")
var changes=true;if(newSettings.month<12)
{newSettings.month++;if(!newSettings.allowChangeYear&&newSettings.month==12)
{$("button.next-month",this).hide();$("button.prev-month",this).show();}
else
{$("button.next-month, button.prev-month",this).show();}}
else
{if(newSettings.allowChangeYear)
{newSettings.month=1;newSettings.year++;}
else
{changes=false;}}
if(changes)
{newSettings.target=this;$(this).trigger("periodChanged");methods.init(newSettings);}
return this;},prevMonth:function()
{$(this).trigger("beforePeriodChange");var newSettings=$(this).data("settings.jaCalendar");var changes=true;if(newSettings.month>1)
{newSettings.month--;if(!newSettings.allowChangeYear&&newSettings.month==1)
{$("button.next-month",this).show();$("button.prev-month",this).hide();}
else
{$("button.next-month, button.prev-month",this).show();}}
else
{if(newSettings.allowChangeYear)
{newSettings.month=12;newSettings.year--;}
else
{changes=false;}}
if(changes)
{newSettings.target=this;$(this).trigger("periodChanged");methods.init(newSettings);}
return this;},changePeriod:function(month,year)
{$(this).trigger("beforePeriodChange");var newSettings=$(this).data("settings.jaCalendar");newSettings.month=month;newSettings.year=year;newSettings.target=this;$(this).trigger("periodChanged");methods.init(newSettings);return this;},now:function()
{$(this).trigger("beforePeriodChange");var newSettings=$(this).data("settings.jaCalendar");newSettings.month=new Date().getMonth()+1;newSettings.year=new Date().getFullYear();newSettings.target=this;$(this).trigger("periodChanged");methods.init(newSettings);return this;},dateDiff:function()
{var d=this.data("selectedDate.jaCalendar");return(+d.to-+d.from)/1000/60/60/24;}};if(method&&typeof method!=='object'&&method!="init")
{return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}
var mainArgs=arguments;return this.each(function(){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(mainArgs,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,mainArgs);}else{$.error('Method '+method+' does not exist on jQuery.jaCalendar');}});};$.fn.jaCalendar.selectionModes={single:'single',range:'range'};$.fn.jaCalendar.defaults={selectedDateChanged:null,periodChanged:null,beforePeriodChanged:null,selectedRangeChanged:null,shortDayNames:true,shortDayNameLength:3,leadingZero:false,highlightToday:true,blurWeekend:true,month:new Date().getMonth()+1,year:new Date().getFullYear(),specialDates:[],allowChangeMonth:true,allowChangeYear:true,usePeriodInput:false,showTodayButton:true,selectionMode:$.fn.jaCalendar.selectionModes.single,minRangeLength:-1,maxRangeLength:-1,allowPastDates:false,todayButtonLabel:"Hoy",goPeriodButtonLabel:"Ir",days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]};$.fn.jaCalendar.period=function(settings,selectedYear,selectedMonth)
{return settings.months[selectedMonth]+" "+selectedYear;};$.fn.jaCalendar.header=function(settings,selectedYear,selectedMonth)
{var $header=$newRow();$header.addClass("header");var $headerTh=$("<th />");var $headerSpan=$("<span class='header-label'></span>");if(!settings.usePeriodInput)
{$headerSpan.html($.fn.jaCalendar.period(settings,selectedYear,selectedMonth));$headerSpan.appendTo($headerTh);}
else
{var $headerMonths=$("<select class='month-list'></select>");$.each(settings.months,function(i,month){$("<option "+(i+1==settings.month?"selected":"")+" value='"+i+"'>"+month+"</option>").appendTo($headerMonths);});var $headerYear=$("<input type='text' maxlength='4' size='4' class='year-input' value='"+selectedYear+"' />");var $headerGoPeriod=$("<button class='go-period-button'>"+settings.goPeriodButtonLabel+"</button>");$headerMonths.appendTo($headerTh);$headerYear.appendTo($headerTh);$headerGoPeriod.appendTo($headerTh);}
var $headerBtnPrev=$("<button class='prev-month'>&lt;</button>");var $headerBtnNext=$("<button class='next-month'>&gt;</button>");$headerBtnPrev.appendTo($headerTh);$headerBtnNext.appendTo($headerTh);$headerTh.attr("colspan",7);$headerTh.appendTo($header);var $tr=$newRow();$tr.attr("class","days");$.each(settings.days,function(i,d){if(settings.shortDayNames)
{d=d.substr(0,settings.shortDayNameLength);}
$("<th>"+d+"</th>").appendTo($tr);});return[$header,$tr];};$.fn.jaCalendar.footer=function(settings)
{var $footer=$newRow().addClass("footer");var $td=$("<td colspan='7' />");if(settings.showTodayButton)
{var $todayBtn=$("<button class='today-button'>"+settings.todayButtonLabel+"</button>");$todayBtn.appendTo($td);}
if($td.children().length>0)
{$td.appendTo($footer);return[$footer];}}
$.fn.jaCalendar.weekdays=function(weeksInMonth)
{var weekRowArray=[];for(var w=0;w<=weeksInMonth;w++)
{var $weekRow=$newRow().addClass("weekrow");for(var j=0;j<7;j++)
{$("<td class='date "
+(j==0||j==6?"weekend":"")
+" week"+(w+1)
+" day"+(j)+"' />").appendTo($weekRow);}
weekRowArray.push($weekRow);}
return weekRowArray;}
$.fn.jaCalendar.selectDate=function($calendar,settings)
{switch(settings.selectionMode.toLowerCase())
{case"single":$calendar.data("selectedDate.jaCalendar",$(this).data("date"));$("td.date",$calendar).removeClass("selected");$(this).addClass("selected");break;case"range":if($calendar.data("selectedDate.jaCalendar")===undefined||($calendar.data("selectedDate.jaCalendar").from!=null&&$calendar.data("selectedDate.jaCalendar").to!=null))
{$calendar.data("selectedDate.jaCalendar",{from:$(this).data("date"),to:null});$("td.date",$calendar).removeClass("selected");$(this).addClass("selected");}
else
{var fromDate=$calendar.data("selectedDate.jaCalendar").from;var toDate=$(this).data("date");var $days=$("td.date",$calendar);var $firstDay=$("td.date.selected",$calendar);var fromIndex=$days.index($firstDay);var toIndex=$days.index($(this));var dateDiff=(+toDate-+fromDate)/1000/60/60/24;if(fromIndex<0)fromIndex=0;var d=0;settings.maxRangeLength=settings.maxRangeLength==-1?toIndex:settings.maxRangeLength;if(+toDate<=+fromDate)
{$calendar.data("selectedDate.jaCalendar",{from:$(this).data("date"),to:null});$("td.date",$calendar).removeClass("selected");$(this).addClass("selected");return;}
if(dateDiff<settings.minRangeLength-1&&settings.minRangeLength!=-1)
return;for(var i=fromIndex;i<=toIndex;i++)
{if(!$($days[i]).hasClass("selectable")||d>=settings.maxRangeLength)
{break;}
$($days[i]).addClass("selected");d++;}
$calendar.data("selectedDate.jaCalendar",{from:fromDate,to:$($days[i-1]).data("date")});$calendar.trigger("selectedRangeChanged");}
break;}
$calendar.trigger("selectedDateChanged");}})(jQuery);